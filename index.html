<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>你是甚麼圖書館角色？</title>
    <style>
        :root {
            --gray-100: #f7f7f7;
            --gray-200: #ededed;
            --gray-300: #d6d6d6;
            --gray-400: #b0b0b0;
            --gray-500: #888888;
            --gray-600: #555555;
            --gray-700: #333333;
            --gray-800: #1a1a1a;
            --gray-900: #111111;
            --primary: var(--gray-700);
            --secondary: var(--gray-400);
            --accent: var(--gray-600);
        }

        html {
            box-sizing: border-box;
            font-size: 16px;
        }
        *, *:before, *:after {
            box-sizing: inherit;
        }
        body {
            font-family: 'Microsoft JhengHei', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            color: var(--gray-800);
            display: flex;
            justify-content: center; /* Centers horizontally */
            align-items: center; /* Centers vertically */
            background:
                url('https://raw.githubusercontent.com/kei4di1/Library-user-test/main/assets/background.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            position: relative;
            min-height: 100vh;
        }
        .container {
            max-width: 800px;
            width: 100%;
            margin: 0 auto;
            padding: 20px;
            border-radius: 16px;
        }
        h1 {
            color: var(--gray-700);
            text-align: center;
            margin-bottom: 2rem;
            font-weight: 700;
            text-shadow: none;
            background: none;
            -webkit-background-clip: initial;
            -webkit-text-fill-color: initial;
            font-size: 2.5rem;
        }
        .question {
            background: var(--gray-100, 0.8);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 6px rgba(128, 128, 128, 0.07);
            border: 1.5px solid var(--gray-300);
            transition: transform 0.3s, box-shadow 0.3s;
            display: none;
        }
        .question:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(128, 128, 128, 0.12);
        }
        .options {
            margin-top: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .option {
            margin: 0;
            padding: 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            border: 1.5px solid var(--gray-300);
            background: var(--gray-200);
            font-size: 1rem;
            min-width: 0;
            word-break: break-word;
            color: var(--gray-800);
        }
        .option:hover, .option.selected {
            background: var(--gray-400);
            color: var(--gray-900);
            border-color: var(--gray-500);
            transform: translateX(4px);
            opacity: 1;
        }
        .progress {
            margin-bottom: 1.5rem;
            text-align: center;
        }
        .progress-bar {
            height: 12px;
            background: var(--gray-200);
            border-radius: 6px;
            margin-top: 10px;
            overflow: hidden;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        .progress-fill {
            height: 100%;
            background: var(--gray-500);
            width: 0%;
            transition: width 0.5s;
        }
        .result {
            display: none;
            background: var(--gray-100);
            border-radius: 12px;
            padding: 2rem 1rem;
            margin: 2rem auto 0 auto;
            box-shadow: 0 2px 8px rgba(128, 128, 128, 0.07);
            border-left: 5px solid var(--gray-600);
            max-width: 600px;
            width: 100%;
        }
        .role-name {
            font-size: 2rem;
            margin-bottom: 1rem;
            text-align: center;
            font-weight: 700;
            color: var(--gray-700);
            text-shadow: none;
        }
        .role-description {
            margin-bottom: 1.5rem;
            text-align: center;
            font-size: 1.125rem;
            line-height: 1.7;
            color: var(--gray-600);
        }
        .restart-btn {
            background: var(--gray-600);
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            font-size: 1rem;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 1.5rem;
            transition: background 0.3s, transform 0.3s, box-shadow 0.3s;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(128, 128, 128, 0.15);
            width: 100%;
            max-width: 300px;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        .restart-btn:hover {
            background: var(--gray-800);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(128, 128, 128, 0.18);
        }
        .role-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            text-align: center;
            color: var(--gray-600);
        }
        .role-image {
            width: 100%;
            max-width: 480px;
            height: auto;
            object-fit: contain;
            margin: 0 auto 1.25rem auto;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(128, 128, 128, 0.10);
            border: 3px solid var(--gray-500);
            display: block;
        }
        form {
            width: 100%;
        }
        /* Responsive styles */
        @media (max-width: 600px) {
            html {
                font-size: 15px;
            }
            .container {
                padding: 8px;
            }
            .question {
                padding: 1rem;
            }
            .result {
                padding: 1rem 0.5rem;
            }
            .role-image {
                max-width: 90vw;
            }
            h1 {
                font-size: 1.3rem;
            }
            .role-name {
                font-size: 1.2rem;
            }
            .role-description {
                font-size: 1rem;
            }
            .option {
                font-size: 1rem;
                padding: 0.75rem;
            }
        }
        @media (max-width: 400px) {
            html {
                font-size: 13px;
            }
            .container {
                padding: 2px;
            }
            .role-image {
                max-width: 100vw;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
<div class="container">

<h1><i class="fas fa-book-reader"></i> 圖書館角色測驗</h1>

<div class="progress">
    <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
    </div>
    <p id="progressText">問題 1/6</p>
</div>

<form id="quizForm">
    <!-- 問題 1 -->
    <div class="question" id="q1" data-question="1">
        <p><i class="fas fa-question-circle"></i> 提到圖書館，你第一項想到的設施／服務是？</p>
        <div class="options">
            <div class="option" data-question="1" data-option="A">大幅面打印機</div>
            <div class="option" data-question="1" data-option="B">書架上的新書</div>
            <div class="option" data-question="1" data-option="C">小組討論室</div>
            <div class="option" data-question="1" data-option="D">舒適的座位</div>
        </div>
    </div>

    <!-- 問題 2 -->
    <div class="question" id="q2" data-question="2">
        <p><i class="fas fa-question-circle"></i> 又到學期中了，圖書館可以如何協助我渡過呢？</p>
        <div class="options">
            <div class="option" data-question="2" data-option="A">提供安靜的空間讓我專心備課或溫習</div>
            <div class="option" data-question="2" data-option="B">舉辦工作坊幫我提升技能或減壓</div>
            <div class="option" data-question="2" data-option="C">有齊電子資源和資料庫，幫我完成報告</div>
            <div class="option" data-question="2" data-option="D">討論室讓我和同學一起準備小組報告</div>
        </div>
    </div>

    <!-- 問題 3 -->
    <div class="question" id="q3" data-question="3">
        <p><i class="fas fa-question-circle"></i> 當我想提升自己時，我會依靠圖書館的＿＿＿＿＿</p>
        <div class="options">
            <div class="option" data-question="3" data-option="A">工作坊與講座，幫助我學習新技能</div>
            <div class="option" data-question="3" data-option="B">電子資源與資料庫，支援我的研究與報告</div>
            <div class="option" data-question="3" data-option="C">安靜空間，讓我專注思考與自我整理</div>
            <div class="option" data-question="3" data-option="D">討論區與同儕交流，激發更多想法</div>
        </div>
    </div>

    <!-- 問題 4 -->
    <div class="question" id="q4" data-question="4">
        <p><i class="fas fa-question-circle"></i> 當我需要靈感或放鬆一下時，我會＿＿＿＿＿</p>
        <div class="options">
            <div class="option" data-question="4" data-option="A">逛逛書架，看看有沒有新書吸引我</div>
            <div class="option" data-question="4" data-option="B">查找資料庫或電子資源</div>
            <div class="option" data-question="4" data-option="C">動手做點東西，例如剪貼、設計或3D列印</div>
            <div class="option" data-question="4" data-option="D">和朋友聊聊想法，激發新點子</div>
        </div>
    </div>

    <!-- 問題 5 -->
    <div class="question" id="q5" data-question="5">
        <p><i class="fas fa-question-circle"></i> 我最喜歡圖書館的＿＿＿＿＿</p>
        <div class="options">
            <div class="option" data-question="5" data-option="A">創作工具和製作空間</div>
            <div class="option" data-question="5" data-option="B">書架和閱讀區</div>
            <div class="option" data-question="5" data-option="C">活動和工作坊場地</div>
            <div class="option" data-question="5" data-option="D">安靜的休息角落</div>
        </div>
    </div>

    <!-- 問題 6 -->
    <div class="question" id="q6" data-question="6">
        <p><i class="fas fa-question-circle"></i> 如果要在圖書館冒險，我的任務是＿＿＿＿＿</p>
        <div class="options">
            <div class="option" data-question="6" data-option="A">找出最隱藏的資料庫寶藏</div>
            <div class="option" data-question="6" data-option="B">動手打造屬於自己的創意作品</div>
            <div class="option" data-question="6" data-option="C">參加任務挑戰，解鎖新技能</div>
            <div class="option" data-question="6" data-option="D">在書海中尋找靈感與故事</div>
        </div>
    </div>
</form>

<div class="result" id="result">
    <img class="role-image" id="roleImage" style="display:none;" />
    <div class="role-icon" id="roleIcon"></div>
    <div class="role-name" id="roleName"></div>
    <div class="role-description" id="roleDescription"></div>
    <button type="button" class="restart-btn" id="restartBtn">重新測驗</button>
</div>

<script>
// 角色資訊
const roles = {
    '靈感工程師': {
        description: '你是圖書館創客空間的常客，喜歡動手做事和探索新技術。圖書館的創作工具和製作空間是你的最愛，你總是能找到靈感來創造獨一無二的作品。',
        icon: '<i class="fas fa-tools"></i>',
        color: '#ff6b6b',
        image: 'https://raw.githubusercontent.com/kei4di1/Library-user-test/main/assets/maker.png'
    },
    '書海探險家': {
        description: '你是一個熱愛閱讀和探索的人，書架上的新書和書海中的故事總是吸引著你的目光，在書本中尋找靈感和故事。',
        icon: '<i class="fas fa-book"></i>',
        color: '#48dbfb',
        image: 'https://raw.githubusercontent.com/kei4di1/Library-user-test/main/assets/reader.png'
    },
    '思辨夥伴': {
        description: '你喜歡在討論區、學習小組或與朋友交流想法，圖書館是你激發思考與交換觀點的場域。',
        icon: '<i class="fas fa-users"></i>',
        color: '#1dd1a1',
        image: 'https://raw.githubusercontent.com/kei4di1/Library-user-test/main/assets/buddy.png'
    },
    '靜謐旅人': {
        description: '你善用圖書館的空間，無論是自修、休憩或靈感發想，圖書館是你的心靈基地。',
        icon: '<i class="fas fa-couch"></i>',
        color: '#feb019',
        image: 'https://raw.githubusercontent.com/kei4di1/Library-user-test/main/assets/rester.png'
    },
    '活動探索者': {
        description: '你喜歡參與活動和學習新技能，圖書館的工作坊和講座是你的最愛。你總是能從活動中獲得新的知識和技能。',
        icon: '<i class="fas fa-graduation-cap"></i>',
        color: '#2d3436',
        image: 'https://raw.githubusercontent.com/kei4di1/Library-user-test/main/assets/participant.png'
    },
    '知識獵人': {
        description: '你擅長使用圖書館資料庫、電子資源和研究工具，總能找到最精準的資訊，是研究路上的高手。',
        icon: '<i class="fas fa-search"></i>',
        color: '#533483',
        image: 'https://raw.githubusercontent.com/kei4di1/Library-user-test/main/assets/searcher.png'
    }
};

// 角色對應表 - 完全按照您提供的對應關係
const roleMap = {
    '1': {
        'A': '靈感工程師',
        'B': '書海探險家',
        'C': '思辨夥伴',
        'D': '靜謐旅人'
    },
    '2': {
        'A': '靜謐旅人',
        'B': '活動探索者',
        'C': '知識獵人',
        'D': '思辨夥伴'
    },
    '3': {
        'A': '活動探索者',
        'B': '知識獵人',
        'C': '靜謐旅人',
        'D': '思辨夥伴'
    },
    '4': {
        'A': '書海探險家',
        'B': '知識獵人',
        'C': '靈感工程師',
        'D': '思辨夥伴'
    },
    '5': {
        'A': '靈感工程師',
        'B': '書海探險家',
        'C': '活動探索者',
        'D': '靜謐旅人'
    },
    '6': {
        'A': '知識獵人',
        'B': '靈感工程師',
        'C': '活動探索者',
        'D': '書海探險家'
    }
};

// 當前問題索引
let currentQuestion = 0;
// 選擇的答案
const selectedAnswers = {};
// 角色計分
const roleScores = {
    '靈感工程師': 0,
    '書海探險家': 0,
    '思辨夥伴': 0,
    '靜謐旅人': 0,
    '活動探索者': 0,
    '知識獵人': 0
};

// 所有問題元素
const questions = ['q1', 'q2', 'q3', 'q4', 'q5', 'q6'];

// 初始化

function preloadImages() {
    const images = [
        'https://raw.githubusercontent.com/kei4di1/Library-user-test/main/assets/maker.png',
        'https://raw.githubusercontent.com/kei4di1/Library-user-test/main/assets/reader.png',
        'https://raw.githubusercontent.com/kei4di1/Library-user-test/main/assets/buddy.png',
        'https://raw.githubusercontent.com/kei4di1/Library-user-test/main/assets/rester.png',
        'https://raw.githubusercontent.com/kei4di1/Library-user-test/main/assets/participant.png',
        'https://raw.githubusercontent.com/kei4di1/Library-user-test/main/assets/searcher.png'
    ];

    images.forEach(src => {
        const img = new Image();
        img.src = src;
        img.style.display = 'none'; // 隱藏預加載的圖片
        document.body.appendChild(img);
    });
}

// 修改後的初始化函數

function restartQuiz() {
    init();
}
function init() {
    // 重置所有變數
    currentQuestion = 0;
    for (const role in roleScores) {
        roleScores[role] = 0;
    }

    // 重置所有問題狀態
    document.querySelectorAll('.question').forEach(question => {
        question.style.display = 'none';
    });

    // 顯示第一個問題
    document.getElementById(questions[0]).style.display = 'block';

    // 顯示表單
    document.getElementById('quizForm').style.display = 'block';

    // 隱藏結果
    document.getElementById('result').style.display = 'none';

    // 重置進度條
    updateProgress();

    // 重置所有選項的選取狀態
    document.querySelectorAll('.option').forEach(option => {
        option.classList.remove('selected');
    });
}


// 更新進度條
function updateProgress() {
    const progress = ((currentQuestion + 1) / questions.length) * 100;
    document.getElementById('progressFill').style.width = progress + '%';
    document.getElementById('progressText').textContent = `問題 ${currentQuestion + 1}/${questions.length}`;
}

// 顯示下一個問題
function showNextQuestion() {
    if (selectedAnswers[currentQuestion + 1]) {
        // 計算角色分數
        const role = roleMap[currentQuestion + 1][selectedAnswers[currentQuestion + 1]];
        roleScores[role]++;

        // 隱藏所有題目（這行是關鍵！）
        document.querySelectorAll('.question').forEach(question => {
            question.style.display = 'none';
        });

        // 如果是最後一個問題
        if (currentQuestion === questions.length - 1) {
            showResult();
            return;
        }

        // 顯示下一個問題
        currentQuestion++;
        document.getElementById(questions[currentQuestion]).style.display = 'block';

        // 更新進度條
        updateProgress();

        // 重置選項選取狀態
        document.querySelectorAll(`.question[data-question="${currentQuestion + 1}"] .option`).forEach(opt => {
            opt.classList.remove('selected');
        });
    } else {
        alert('請選擇一個答案才能繼續');
    }
}

function showResult() {
    // 找出分數最高的角色
    let maxScore = 0;
    let topRoles = [];

    for (const role in roleScores) {
        if (roleScores[role] > maxScore) {
            maxScore = roleScores[role];
            topRoles = [role];
        } else if (roleScores[role] === maxScore) {
            topRoles.push(role);
        }
    }

    // 如果有多個角色分數相同，隨機選一個
    const resultRole = topRoles.length > 1 ?
        topRoles[Math.floor(Math.random() * topRoles.length)] :
        topRoles[0];

    // 顯示結果
    document.getElementById('roleIcon').innerHTML = roles[resultRole].icon;
    document.getElementById('roleName').textContent = resultRole;
    document.getElementById('roleName').style.color = roles[resultRole].color;
    document.getElementById('roleDescription').textContent = roles[resultRole].description;

    // 如果有圖片網址，則顯示圖片
    if (roles[resultRole].image) {
        const img = document.getElementById('roleImage');
        img.style.display = 'block';
        img.src = roles[resultRole].image;
        img.alt = resultRole + '角色圖片';

        // 圖片加載成功時
        img.onload = function() {
            console.log('圖片加載成功:', roles[resultRole].image);
        };

        // 圖片加載失敗時
        img.onerror = function() {
            console.error('圖片加載失敗:', roles[resultRole].image);
            img.style.display = 'none';
            alert('角色圖片加載失敗，請檢查網路連接或重試');
        };
    } else {
        document.getElementById('roleImage').style.display = 'none';
    }

    // 顯示結果面板
    document.getElementById('result').style.display = 'block';

    // 隱藏表單
    document.getElementById('quizForm').style.display = 'none';
}


// 修改後的事件監聽器
document.addEventListener('DOMContentLoaded', function() {
    preloadImages();

    document.querySelectorAll('.option').forEach(option => {
        option.addEventListener('click', function() {
            const qNum = this.dataset.question;
            // 只在當前題目才處理跳題
            if (parseInt(qNum) - 1 !== currentQuestion) return;
            document.querySelectorAll(`.question[data-question="${qNum}"] .option`).forEach(opt => {
                opt.classList.remove('selected');
            });
            this.classList.add('selected');
            selectedAnswers[qNum] = this.dataset.option;
            showNextQuestion();
        });
    });

    document.getElementById('restartBtn').addEventListener('click', restartQuiz);

    init();
});
</script>
</body>
</html>
